<html>
<head>

<link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/autofill/2.3.3/css/autoFill.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.5.6/css/buttons.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/colreorder/1.5.1/css/colReorder.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/fixedcolumns/3.2.6/css/fixedColumns.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/3.1.5/css/fixedHeader.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css">
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.5.6/css/buttons.bootstrap4.min.css">



</head>

​<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.10.18/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
<script src="https://cdn.datatables.net/autofill/2.3.3/js/dataTables.autoFill.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"></script>

​

<body>
<div id="east_div">
	<h3>Standings - Eastern Conference</h3>
	<table id="east_datatable_table" class="table table-striped table-bordered" style="width:100%"></table>
</div>
<div id="east_div">
	<h3>Standings - Western Conference</h3>
	<table id="west_datatable_table" class="table table-striped table-bordered" style="width:100%"></table>
</div>

<div id="input_table" style="display:none">
	<p>
	<script src='https://www2.cricketstatz.com/ss/linkreport.aspx?mode=1&club=23365&playerid=&mininns=&minruns=&minovers=&team=&grade=9302&pool=&season=2019&finals=0'></script>
	</p>
</div>



 
 <script>
 
	var conferenceMapping = {"Albion": "West", "University": "West", "Colts Weekend": "West", "Alcos": "West", "Oak Bay": "West",
							 "Islanders": "East", "Incogs": "East", "Nanaimo": "East", "Metchosin Weekend": "East", "Cowichan": "East"};
	
	var waitForEl = function(selector, callback, count) {
	  if (jQuery(selector).length) {
		callback();
	  } else {
		setTimeout(function() {
		  if(!count) {
			count=0;
		  }
		  count++;
		  if(count<10) {
			waitForEl(selector,callback,count);
		  } else {return;}
		}, 100);
	  }
	};

	// Wait for east table to arrive from report, then parse it
	var selector = $("#input_table .ss_table");
	var headers = [];
	var content = [];
	waitForEl(selector, function() {
		
		// Pull data out of table
		var row;
		$('#input_table table').find('tr').each(function(){
			if (this.className == "ss_tablehead") {
				$(this).find('td').each(function(ix, e){
					headers.push({"title": e.textContent});
				});
			} else {
				row = []
				$(this).find('td').each(function(ix, e){
					row.push(e.textContent);
				});
				content.push(row);
			}
		});
		// Delete elements
		selector.remove();
		$(".ss_title").remove();
	});
	
	// We have the data, now need to split out and tidy up
	// First step - add the conference
	content.forEach(function(element) { element.push(conferenceMapping[element[1]]); });
	headers.push({"title": "Conference"});
	
	// Split content out
	var east_content = [];
	var west_content = [];
	content.forEach(function(element) { if (element.slice(-1) == "West") { west_content.push(element) } else { east_content.push(element) } } );
	
	// Select only columns we want
	east_content.forEach(function(element, index) { this[index] = element.slice(1,8)}, east_content);
	west_content.forEach(function(element, index) { this[index] = element.slice(1,8)}, west_content);
	headers = headers.slice(1,8);
	
	console.log(west_content);
	console.log(east_content);
	console.log(headers);
	
	// Set tables
	$('#east_datatable_table').DataTable( {
		data: east_content,
		columns: headers,
		paging: false,
		columnDefs: [{"className": "dt-center", "targets": "_all"}],
		searching: false,
		info: false,
		order: [[6, "desc"]]
	} );
	$('#west_datatable_table').DataTable( {
		data: west_content,
		columns: headers,
		paging: false,
		columnDefs: [{"className": "dt-center", "targets": "_all"}],
		searching: false,
		info: false,
		order: [[6, "desc"]]
	} );
	
</script>


</body>
</html>